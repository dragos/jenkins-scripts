#!/bin/bash -x

publish=$1
artifactsDir=$2

scriptsDir="$( cd "$( dirname "$0" )/.." && pwd )"

# allows passing compiler flags in scala-checkin-manual
if [[ "$scalacArgs" != "" ]] ; then
  antArgsCompiler="-Dscalac.args=\"$scalacArgs\" -Dpartest.scalac_opts=\"$scalacArgs\""
fi

antArgs="-Darchives.skipxz=true $antArgsCompiler" $scriptsDir/build
buildState=$?
$scriptsDir/archive-checkin
if [[ $publish == "publish" ]] ; then
    $scriptsDir/publish-checkin $artifactsDir
fi
publishState=$?

# i'm not a bash programmer.
if (( !($buildState || $publishState) )) ; then
  exit 0
else
  exit 1
fi
